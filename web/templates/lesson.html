<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ lesson.title }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<div class="container">

  <a class="back" href="/">‚Üê –ù–∞–∑–∞–¥</a>

  <h1>{{ lesson.title }}</h1>
  <p>–ö–æ–¥ —É—Ä–æ–∫–∞: <b>{{ lesson.code }}</b></p>

  <div class="card {% if stats.dislike_count > stats.like_count %}problem{% endif %}">
    <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>

    <p>–í—Å–µ–≥–æ –æ—Ç–≤–µ—Ç–æ–≤: <b>{{ stats.total or 0 }}</b></p>

    <p>–°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞:</p>
    <div class="rating-scale">
      {% for i in range(1, 6) %}
        <div class="rating-dot {% if stats.avg_rating and i <= stats.avg_rating|round(0, 'floor') %}active{% endif %}"></div>
      {% endfor %}
    </div>

    <div class="chart">
      <p>üëç –ü–æ–Ω—è—Ç–Ω–æ ({{ stats.like_count or 0 }})</p>
      <div class="bar">
        <div class="bar-fill bar-like"
             style="width: {{ (stats.like_count / stats.total * 100) if stats.total else 0 }}%">
        </div>
      </div>

      <p>üòê –°—Ä–µ–¥–Ω–µ ({{ stats.ok_count or 0 }})</p>
      <div class="bar">
        <div class="bar-fill bar-ok"
             style="width: {{ (stats.ok_count / stats.total * 100) if stats.total else 0 }}%">
        </div>
      </div>

      <p>üëé –ù–µ–ø–æ–Ω—è—Ç–Ω–æ ({{ stats.dislike_count or 0 }})</p>
      <div class="bar">
        <div class="bar-fill bar-dislike"
             style="width: {{ (stats.dislike_count / stats.total * 100) if stats.total else 0 }}%">
        </div>
      </div>
    </div>
  </div>

  <div class="card">
    <h2>–ê–Ω–æ–Ω–∏–º–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h2>
    <ul>
      {% for q in questions %}
        <li>{{ q.text }}</li>
      {% else %}
        <li>–ü–æ–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–µ—Ç</li>
      {% endfor %}
    </ul>
  </div>

  <div class="card">
    <h2>–û—Ü–µ–Ω–∫–∏</h2>
    <ul>
      {% for c in comments %}
        <li>({{ c.mood }}, {{ c.rating }}/5) ‚Äî {{ c.comment }}</li>
      {% else %}
        <li>–ü–æ–∫–∞ –æ—Ü–µ–Ω–æ–∫ –Ω–µ—Ç</li>
      {% endfor %}
    </ul>
  </div>

</div>

</body>
</html>
