<!doctype html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ü–∞–Ω–µ–ª—å —É—á–∏—Ç–µ–ª—è</title>

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<!-- ===== HEADER ===== -->
<header class="top-bar">
  <h1>üìä –ü–∞–Ω–µ–ª—å —É—á–∏—Ç–µ–ª—è</h1>

  <button id="theme-toggle" class="theme-btn" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
    üåô
  </button>
</header>

<div class="container">

  <!-- ===== –û–ë–©–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê ===== -->
  <section class="stats">
    <div class="stat-card">
      <h3>üìö –£—Ä–æ–∫–æ–≤</h3>
      <p>{{ lessons|length }}</p>
    </div>

    <div class="stat-card">
      <h3>üìù –í—Å–µ–≥–æ –æ—Ü–µ–Ω–æ–∫</h3>
      <p>{{ total_feedback }}</p>
    </div>

    <div class="stat-card">
      <h3>‚≠ê –°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞</h3>
      <p>{{ avg_rating }}</p>
    </div>
  </section>

  <!-- ===== –°–û–ó–î–ê–ù–ò–ï –£–†–û–ö–ê ===== -->
  <div class="card create-lesson">
  <h3>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —É—Ä–æ–∫</h3>

  <form method="post" action="{{ url_for('create_lesson') }}" class="create-form">
    <input
      type="text"
      name="title"
      placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞"
      required
    >
    <button type="submit">–°–æ–∑–¥–∞—Ç—å</button>
  </form>
</div>

  <!-- ===== –°–ü–ò–°–û–ö –£–†–û–ö–û–í ===== -->
  <h2>–°–ø–∏—Å–æ–∫ —É—Ä–æ–∫–æ–≤</h2>

  {% for lesson in lessons %}
    <div class="lesson-item">
      <div class="lesson-info">
        <b>
          <a href="{{ url_for('lesson_page', lesson_id=lesson.id) }}">
            {{ lesson.title }}
          </a>
        </b>
        <div class="muted">–ö–æ–¥ —É—Ä–æ–∫–∞: {{ lesson.code }}</div>
      </div>

      <div class="lesson-status">
        {% if lesson.total == 0 %}
          <span class="status neutral">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</span>
        {% elif lesson.dislike_count > 0 %}
          <span class="status bad">–ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</span>
        {% elif lesson.ok_count > 0 %}
          <span class="status warn">–ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã</span>
        {% else %}
          <span class="status good">–í—Å—ë —Ö–æ—Ä–æ—à–æ</span>
        {% endif %}

      </div>
    </div>
  {% else %}
    <p class="muted">–£—Ä–æ–∫–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>
  {% endfor %}

</div>

<footer>
  –ê–Ω–æ–Ω–∏–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ —É—Ä–æ–∫–æ–≤ ‚Ä¢ –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ú–∏—Ö–∞–π–ª–æ–≤–æ–π –ö—Å–µ–Ω–∏–∏
</footer>

<!-- ===== JS: –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –¢–ï–ú–´ ===== -->
<script>
const btn = document.getElementById("theme-toggle");

function applyTheme(theme) {
  document.body.classList.toggle("light", theme === "light");
  btn.textContent = theme === "light" ? "üåô" : "‚òÄÔ∏è";
}

const savedTheme = localStorage.getItem("theme") || "dark";
applyTheme(savedTheme);

btn.onclick = () => {
  const newTheme = document.body.classList.contains("light") ? "dark" : "light";
  localStorage.setItem("theme", newTheme);
  applyTheme(newTheme);
};
</script>

</body>
</html>
